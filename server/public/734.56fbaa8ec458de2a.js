"use strict";(self.webpackChunkmantis_free_version=self.webpackChunkmantis_free_version||[]).push([[734],{1734:(w,m,s)=>{s.r(m),s.d(m,{CategoryModule:()=>x});var g=s(6814),p=s(1076),a=s(95),t=s(5879),h=s(450),C=s(485),v=s(4087),Z=s(1326),b=s(6593);function T(n,l){if(1&n&&(t.TgZ(0,"option",34),t._uU(1),t.qZA()),2&n){const e=l.$implicit;t.Q6J("value",e._id),t.xp6(1),t.hij(" ",e.name," ")}}function A(n,l){if(1&n){const e=t.EpF();t.TgZ(0,"span",35),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.openUrl(i.url))}),t._UZ(1,"i",36),t.qZA()}}let U=(()=>{class n{constructor(e,o,i,r,c,u,I){this.router=e,this.activated=o,this.categoryService=i,this.toastService=r,this.spinner=c,this.validationService=u,this.domSanitizer=I,this.submitted=!1,this.categoryId=null,this.fileName="",this.url=null,this.file=null,this.categoryForm=new a.cw({_id:new a.NI(null),name:new a.NI("",[a.kI.required]),slug:new a.NI("",[a.kI.required]),image:new a.NI(""),status:new a.NI("active",[a.kI.required]),parentId:new a.NI("")}),this.options=[],this.FORM_ERRORS=[{message:"Name is required",key:"name"},{message:"Slug is required",key:"slug"},{message:"Status is required",key:"status"}]}get f(){return this.categoryForm.controls}ngOnInit(){this.getByParentId(),this.activated.queryParams.subscribe(e=>{e.id&&(this.getdataById(e.id),this.categoryId=e.id)})}submit(){if(console.log("this.categoryForm.value;",this.categoryForm.value),this.submitted=!0,console.log(this.categoryForm.errors),this.validationService.checkErrors(this.categoryForm,this.FORM_ERRORS))return;let e=this.categoryForm.value,o=new FormData;o.append("key","category"),o.append("name",e.name),o.append("slug",e.slug),o.append("status",e.status),o.append("parentId",e.parentId),this.file&&o.append("file",this.file),e._id?this.update(e._id,o):this.create(o)}create(e){this.spinner.show(),this.categoryService.createCategory(e).subscribe(o=>{this.spinner.hide(),this.toastService.success(o.message),this.router.navigate(["default/category/category-list"])})}update(e,o){this.spinner.show(),this.categoryService.updateCategoryById(e,o).subscribe(i=>{this.spinner.hide(),this.toastService.success(i.message),this.router.navigate(["default/category/category-list"])})}getdataById(e){this.spinner.show(),this.categoryService.getbyId(e).subscribe(o=>{this.url=o.image,this.categoryForm.patchValue(o),this.spinner.hide()})}getByParentId(){this.spinner.show(),this.categoryService.getParentId().subscribe(e=>{this.spinner.hide(),this.options=e.map(i=>({_id:i._id,name:i.name})),this.options.unshift({_id:"",name:"Parent"})})}fileChosen(e){if(e.target.files.length){if(e.target.files[0].size>2e6)return void this.toastService.warning("Unable to upload file of size more than 1MB");this.file=e.target.files[0],this.fileName=this.file.name;const i=new FileReader;i.readAsDataURL(this.file),i.onload=()=>{this.url=this.domSanitizer.bypassSecurityTrustUrl(i.result)},i.onerror=r=>{console.error(r)}}}back(){this.router.navigate(["default/category/category-list"])}reset(){this.categoryForm.reset(),this.categoryId&&this.getdataById(this.categoryId)}openUrl(e){console.log("url",e),window.open(e,"_blank")}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(p.F0),t.Y36(p.gz),t.Y36(h.H),t.Y36(C.k),t.Y36(v.V),t.Y36(Z.R),t.Y36(b.H7))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-category-form"]],decls:69,vars:8,consts:[[1,"container-fluid"],[1,"row","my-4"],[1,"d-flex","justify-content-center"],[1,"card","form-card","shadow","rounded","rounded-3"],[1,"card-header","justify-content-start","fs-4","fw-bold"],[1,"d-flex","align-items-center","justify-content-between"],[1,""],[1,"btn","text-white","btn-primary","mx-2","shadow","rounded","rounded-3","d-flex","align-content-center","me-2",3,"click"],[1,"ti","ti-arrow-left","me-1"],[1,"card-body","mt-3","justify-content-center"],[3,"formGroup"],[1,"row"],[1,"col-md-6","mb-2"],[1,"form-label","fw-bold"],[1,"text-danger"],["formControlName","name","placeholder","name","type","text",1,"form-control"],["formControlName","parentId",1,"form-control"],[3,"value",4,"ngFor","ngForOf"],[1,"col-md-6","mb-2","position-relative"],[1,"input-group"],["formControlName","image","placeholder","image","type","file","accept",".png,.jpeg,.jpg,.pdf,.svg",1,"form-control",3,"change"],[1,"input-group-append"],["class","input-group-text h-100","id","inputGroup-sizing-sm",3,"click",4,"ngIf"],["formControlName","status",1,"form-control"],["value","active"],["value","inactive"],[1,"col-md-12","mb-2"],["formControlName","slug","placeholder","slug","id","exampleFormControlTextarea1","rows","3",1,"form-control"],[1,"col-12"],[1,"d-flex","justify-content-center","mt-3","pt-3"],["type","submit",1,"btn","px-5","btn-success","shadow","rounded","rounded-3","mx-2","d-flex","align-items-center",3,"click"],[1,"fa-solid","me-2"],["type","submit",1,"btn","px-5","btn-primary","mx-2","shadow","rounded","rounded-3","d-flex","align-items-center",3,"click"],[1,"fa-solid","fa-arrows-rotate","me-2"],[3,"value"],["id","inputGroup-sizing-sm",1,"input-group-text","h-100",3,"click"],[1,"fa","fa-eye"]],template:function(e,o){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"div",6),t._uU(7,"Category Form"),t.qZA(),t.TgZ(8,"div")(9,"a",7),t.NdJ("click",function(){return o.back()}),t._UZ(10,"i",8),t._uU(11," Back"),t.qZA()()()(),t.TgZ(12,"div",9)(13,"form",10)(14,"div",11)(15,"div",12)(16,"label",13),t._uU(17,"Name "),t.TgZ(18,"span",14),t._uU(19,"*"),t.qZA()(),t._UZ(20,"input",15)(21,"div"),t.qZA(),t.TgZ(22,"div",12)(23,"label",13),t._uU(24,"Parent Id"),t.TgZ(25,"span",14),t._uU(26,"*"),t.qZA()(),t.TgZ(27,"select",16),t.YNc(28,T,2,2,"option",17),t.qZA(),t._UZ(29,"div"),t.qZA()(),t.TgZ(30,"div",11)(31,"div",18)(32,"label",13),t._uU(33,"Image"),t.TgZ(34,"span",14),t._uU(35,"*"),t.qZA()(),t.TgZ(36,"div",19)(37,"input",20),t.NdJ("change",function(r){return o.fileChosen(r)}),t.qZA(),t.TgZ(38,"div",21),t.YNc(39,A,2,0,"span",22),t.qZA()(),t._UZ(40,"div"),t.qZA(),t.TgZ(41,"div",12)(42,"label",13),t._uU(43,"Status"),t.TgZ(44,"span",14),t._uU(45,"*"),t.qZA()(),t.TgZ(46,"select",23)(47,"option",24),t._uU(48,"Active"),t.qZA(),t.TgZ(49,"option",25),t._uU(50,"InActive"),t.qZA()(),t._UZ(51,"div"),t.qZA()(),t.TgZ(52,"div",11)(53,"div",26)(54,"label",13),t._uU(55,"Slug "),t.TgZ(56,"span",14),t._uU(57,"*"),t.qZA()(),t._UZ(58,"textarea",27)(59,"div"),t.qZA()(),t.TgZ(60,"div",11)(61,"div",28)(62,"div",29)(63,"button",30),t.NdJ("click",function(){return o.submit()}),t._UZ(64,"i",31),t._uU(65),t.qZA(),t.TgZ(66,"button",32),t.NdJ("click",function(){return o.reset()}),t._UZ(67,"i",33),t._uU(68," Reset "),t.qZA()()()()()()()()()()),2&e&&(t.xp6(13),t.Q6J("formGroup",o.categoryForm),t.xp6(15),t.Q6J("ngForOf",o.options),t.xp6(11),t.Q6J("ngIf",o.url),t.xp6(24),t.Tol(o.categoryId?"btn-warning":"btn-success"),t.xp6(1),t.Tol(o.categoryId?"fa-pen-to-square":"fa-plus"),t.xp6(1),t.hij(" ",o.categoryId?"Update":"Create"," "))},dependencies:[g.sg,g.O5,a._Y,a.YN,a.Kr,a.Fj,a.EJ,a.JJ,a.JL,a.sg,a.u]}),n})();var d=s(2030),_=s(8672),y=s(9229),f=s(7741);function S(n,l){if(1&n){const e=t.EpF();t.TgZ(0,"div",33)(1,"button",34),t.NdJ("click",function(){const r=t.CHM(e).$implicit;return t.KtG(r.dismiss("Cross click"))}),t.qZA()(),t.TgZ(2,"div",35)(3,"h4",36),t._uU(4," Are you sure you want to Delete ? "),t.qZA()(),t.TgZ(5,"div",37)(6,"button",38),t.NdJ("click",function(){t.CHM(e);const i=t.oxw().$implicit,r=t.oxw();return t.KtG(r.delete(i.id))}),t._uU(7," YES "),t.qZA(),t.TgZ(8,"button",39),t.NdJ("click",function(){const r=t.CHM(e).$implicit;return t.KtG(r.dismiss("Cross click"))}),t._uU(9," NO "),t.qZA()()}}function F(n,l){if(1&n){const e=t.EpF();t.TgZ(0,"tr")(1,"td",25),t._uU(2),t.qZA(),t.TgZ(3,"td",25),t._UZ(4,"img",26),t.qZA(),t.TgZ(5,"td",25),t._uU(6),t.qZA(),t.TgZ(7,"td",25),t._uU(8),t.qZA(),t.TgZ(9,"td",25),t._uU(10),t.qZA(),t.TgZ(11,"td",25),t._uU(12),t.qZA(),t.TgZ(13,"td",27)(14,"button",28),t.NdJ("click",function(){const r=t.CHM(e).$implicit,c=t.oxw();return t.KtG(c.updateUser(r))}),t._UZ(15,"i",29),t.qZA(),t.TgZ(16,"button",30),t.NdJ("click",function(){const r=t.CHM(e).$implicit,c=t.MAs(19),u=t.oxw();return t.KtG(u.open(r.id,c))}),t._UZ(17,"i",31),t.qZA()(),t.YNc(18,S,10,0,"ng-template",null,32,t.W1O),t.qZA()}if(2&n){const e=l.$implicit,o=l.index;t.xp6(2),t.Oqu(o+1),t.xp6(2),t.Q6J("src",e.image,t.LSH),t.xp6(2),t.Oqu(e.name),t.xp6(2),t.Oqu(e.slug),t.xp6(2),t.hij(" ",null!=e&&null!=e.categories&&e.categories.name?null==e||null==e.categories?null:e.categories.name:"Parent"," "),t.xp6(2),t.Oqu(e.status)}}const q=[{path:"",redirectTo:"category-list",pathMatch:"full"},{path:"category-form",component:U},{path:"category-list",component:(()=>{class n{constructor(e,o,i,r){this.router=e,this.categoryService=o,this.spinner=i,this.toastService=r,this.modalService=(0,t.f3M)(d.FF),this.page=1,this.pageSize=8,this.collection=0,this.column="createdAt",this.direction=-1,this.search="",this.category=[]}ngOnInit(){this.getAll()}add(){this.router.navigate(["/default/category/category-form"])}updateUser(e){this.router.navigate(["/default/category/category-form"],{queryParams:{id:e._id}})}onChangePage(e){e>0&&(this.page=e),this.getAll()}open(e,o){this.selectedRow=e,this.modalService.open(o,{centered:!0})}searchFn(){console.log("this.search",this.search),(this.search.toString().length>=3||0==this.search.toString().length)&&this.getAll()}getAll(){this.spinner.show(),this.categoryService.getAllcategory({page:this.page,pageSize:this.pageSize,search:this.search}).subscribe(o=>{this.spinner.hide(),console.log("success",o),this.category=o.data,this.collection=o.count})}delete(e){this.spinner.show(),this.categoryService.deleteCategoryById(e).subscribe(o=>{console.log(o),this.spinner.hide(),this.toastService.success(o.message),this.modalService.dismissAll(),this.getAll()},o=>{console.log(o),this.spinner.hide(),this.toastService.error("Unable to Delete !")})}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(p.F0),t.Y36(h.H),t.Y36(_.t2),t.Y36(y._W))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-category-list"]],decls:40,vars:5,consts:[[1,"container-fluid","table-container"],[1,"card","table-card"],[1,"card-title"],[1,"card-header"],[1,"row","justify-content-between"],[1,"col-4"],[1,"container","input-icons"],[1,"input-group","input-group-sm"],["type","search","aria-label","Small","placeholder","Search","aria-describedby","inputGroup-sizing-sm",1,"form-control",3,"ngModel","ngModelChange","input"],[1,"input-group-append"],["id","inputGroup-sizing-sm",1,"input-group-text","h-100"],[1,"ti","ti-search"],[1,"col-md-4","col-3","text-right"],[1,"btn","add-btn",3,"click"],[1,"ti","ti-plus","me-1"],[1,"card-body","p-4"],[1,"table-responsive"],[1,"table","table-hover"],[1,"thead"],[1,"table-secondary"],["scope","col"],["scope","col",1,"mx-auto","text-center"],[1,"tbody","mt-3"],[4,"ngFor","ngForOf"],[3,"page","pageSize","collection","pageChange","pageSizeChange","collectionChange","myOutput"],["scope","row"],["height","30","width","30",3,"src"],["scope","row",1,"text-center"],["ngbTooltip","Update",1,"btn","btn-sm","status-btn","mx-2",3,"click"],[1,"ti","ti-edit-circle"],["ngbTooltip","Delete",1,"btn","btn-sm","status-btn",3,"click"],[1,"ti","ti-trash"],["deleteModal",""],[1,"modal-header","border-0"],["type","button","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body","border-0"],["id","modal-basic-title",1,"modal-title","text-center"],[1,"modal-footer","justify-content-center","border-0"],["type","button",1,"btn","px-4","btn-outline-danger",3,"click"],["type","button",1,"btn","px-4","btn-outline-primary",3,"click"]],template:function(e,o){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"h3"),t._uU(4,"CategoryList"),t.qZA()(),t.TgZ(5,"div",3)(6,"div",4)(7,"div",5)(8,"div",6)(9,"div",7)(10,"input",8),t.NdJ("ngModelChange",function(r){return o.search=r})("input",function(){return o.searchFn()}),t.qZA(),t.TgZ(11,"div",9)(12,"span",10),t._UZ(13,"i",11),t.qZA()()()()(),t.TgZ(14,"div",12)(15,"button",13),t.NdJ("click",function(){return o.add()}),t._UZ(16,"i",14),t._uU(17," Add Category "),t.qZA()()()(),t.TgZ(18,"div",15)(19,"div",16)(20,"table",17)(21,"thead",18)(22,"tr",19)(23,"th",20),t._uU(24,"Sr. No."),t.qZA(),t.TgZ(25,"th",20),t._uU(26,"Image"),t.qZA(),t.TgZ(27,"th",20),t._uU(28,"Name"),t.qZA(),t.TgZ(29,"th",20),t._uU(30,"Slug"),t.qZA(),t.TgZ(31,"th",20),t._uU(32,"ParentId"),t.qZA(),t.TgZ(33,"th",20),t._uU(34,"Status"),t.qZA(),t.TgZ(35,"th",21),t._uU(36,"Action"),t.qZA()()(),t.TgZ(37,"tbody",22),t.YNc(38,F,20,6,"tr",23),t.qZA()()(),t.TgZ(39,"app-custom-pagination",24),t.NdJ("pageChange",function(r){return o.page=r})("pageSizeChange",function(r){return o.pageSize=r})("collectionChange",function(r){return o.collection=r})("myOutput",function(){return o.onChangePage(o.page)}),t.qZA()()()()),2&e&&(t.xp6(10),t.Q6J("ngModel",o.search),t.xp6(28),t.Q6J("ngForOf",o.category),t.xp6(1),t.Q6J("page",o.page)("pageSize",o.pageSize)("collection",o.collection))},dependencies:[g.sg,a.Fj,a.JJ,a.On,f.W,d._L]}),n})()}];let x=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[g.ez,a.u5,a.UX,y.Rh,_.ef,f.W,d.HK,p.Bz.forChild(q)]}),n})()}}]);